:PROPERTIES:
:ID:       a922b10f-30e2-4720-b1bf-6d934e6e715c
:END:
#+title: Emacs: switch major modes without losing folding information?
* refs : my original question
  https://emacs.stackexchange.com/questions/79155/change-major-mode-without-hiding-text-or-revealing-hidden-text
  https://club.tidalcycles.org/t/emacs-change-major-mode-without-hiding-text-or-revealing-hidden-text/4925
* my solution so far
** Make org-mode open source blocks full-screen for editing.
   '(org-src-window-setup 'current-window) ;; This way `C-c '` (org-edit-special) in org-mode on a code block opens the code-edit window full-screen rather than splitting the frame.
** Use my `org-hide-source-block-delimiters` (C-c h).
*** the code
#+BEGIN_SRC lisp
  (defun org-hide-source-block-delimiters ()
    "Hide #+begin-src / #+end-src lines."
    (interactive)
    (hide-lines-matching
      (rx line-start (zero-or-more " ")
      "#+"
      (or "begin" "end")
      "_src")))
  (global-set-key (kbd "C-c h") 'org-hide-source-block-delimiters)
#+END_SRC
*** TO UNDO THIS, show everything with `M-x hi-sh`
    i.e.
      hide-lines-show-all
** Use yasnippet to insert begin-src / end-src bracket lines.
#+BEGIN_SRC lisp
(setq yas-snippet-dirs
      '( ;; This is a singleton list; it could be longer.
	"~/emacs.d/yasnippets/"))
(add-hook 'org-mode-hook #'yas-minor-mode)
(global-set-key (kbd "C-c y") 'yas-insert-snippet)
#+END_SRC
* an approach: just hide the src delimiters
  https://emacs.stackexchange.com/a/63007/20176
* an approach: use an "indirect buffer"
** problem: can I link the points (cursors)?
   It's possible at least with some coding:
   https://stackoverflow.com/questions/19987071/mirroring-location-in-file-in-two-opened-buffers-side-by-side
** quote from zzkt (nik gaffney)
   consider is using an indirect buffer (try C-x 4 c) to 'clone' your org file
